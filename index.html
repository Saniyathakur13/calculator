<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Calculator</title>
  <style>
    :root{
      --bg:#f1f1f2;
      --card:#ffffff;
      --btn:#f6f6f7;
      --accent:#4a90e2;
      --muted:#777;
      --shadow: 0 6px 18px rgba(20,20,20,0.08);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      color:#111;
      padding:24px;
    }

    .calc {
      width: 320px;
      background:var(--card);
      border-radius:14px;
      box-shadow:var(--shadow);
      padding:16px;
      overflow:hidden;
    }

    /* Display */
    .display {
      width:100%;
      height:64px;
      border-radius:8px;
      border:1px solid #e6e6e7;
      background:linear-gradient(180deg,#fff,#fbfbfb);
      padding:10px 14px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      margin-bottom:14px;
    }
    .display .expr{
      font-size:14px;
      color:var(--muted);
      min-height:18px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }
    .display input{
      border:0;
      outline:0;
      font-size:26px;
      font-weight:600;
      text-align:right;
      width:100%;
      background:transparent;
      padding:0;
      margin-top:4px;
    }

    /* Buttons grid */
    .keys{
      display:grid;
      grid-template-columns: repeat(4,1fr);
      gap:12px;
    }
    button.key{
      height:56px;
      border-radius:10px;
      border:0;
      background:var(--btn);
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
      font-size:18px;
      cursor:pointer;
      transition: transform .06s ease, box-shadow .06s;
      user-select:none;
    }
    button.key:active{ transform: translateY(2px); }
    button.op{ background:#fff4ea; color:#b36a00; font-weight:600; }
    button.equal{
      grid-column: 1 / -1;
      background:var(--accent);
      color: #fff;
      font-weight:700;
    }
    button.wide{ grid-column: span 2; }

    /* small screens */
    @media (max-width:360px){
      .calc{ width: 92vw; }
      .display{ height:58px; }
      button.key{ height:50px; font-size:17px; }
    }
  </style>
</head>
<body>

  <div class="calc" role="application" aria-label="Calculator">
    <div class="display" aria-hidden="false">
      <div class="expr" id="expr"></div>
      <input id="display" inputmode="numeric" aria-label="Calculator display" readonly />
    </div>

    <div class="keys" role="group" aria-label="Calculator keys">
      <button class="key" data-action="digit">7</button>
      <button class="key" data-action="digit">8</button>
      <button class="key" data-action="digit">9</button>
      <button class="key op" data-action="op">/</button>

      <button class="key" data-action="digit">4</button>
      <button class="key" data-action="digit">5</button>
      <button class="key" data-action="digit">6</button>
      <button class="key op" data-action="op">*</button>

      <button class="key" data-action="digit">1</button>
      <button class="key" data-action="digit">2</button>
      <button class="key" data-action="digit">3</button>
      <button class="key op" data-action="op">-</button>

      <button class="key" data-action="digit">0</button>
      <button class="key" data-action="dot">.</button>
      <button class="key" data-action="clear">C</button>
      <button class="key op" data-action="back">âŒ«</button>

      <button class="key equal" data-action="equal">=</button>
    </div>
  </div>

  <script>
    (function(){
      const displayInput = document.getElementById('display');
      const exprDiv = document.getElementById('expr');
      const keys = document.querySelectorAll('button.key');

      let expr = '';      // full expression string
      let current = '';   // current number (for nicer expr preview)

      function updateView(){
        displayInput.value = current || '0';
        exprDiv.textContent = expr;
      }

      function appendDigit(d){
        // avoid multiple leading zeros
        if(current === '0' && d === '0') return;
        if(current === '0' && d !== '.') current = d;
        else current += d;
        updateView();
      }

      function appendDot(){
        if(!current) current = '0.';
        else if(!current.includes('.')) current += '.';
        updateView();
      }

      function pushOperator(op){
        if(!current && !expr) {
          // allow negative start
          if(op === '-') { current = '-'; updateView(); return; }
          return;
        }
        // if current exists, push it
        if(current) {
          expr += current;
          current = '';
        }
        // if expr ends with operator, replace it
        if(/[+\-*/]$/.test(expr)) {
          expr = expr.slice(0,-1) + op;
        } else {
          expr += op;
        }
        updateView();
      }

      function clearAll(){
        expr = '';
        current = '';
        updateView();
      }

      function backspace(){
        if(current){
          current = current.slice(0,-1);
        } else if(expr){
          expr = expr.slice(0,-1);
        }
        updateView();
      }

      function evaluateExpr(){
        // build final expression
        let toEval = expr + (current || '');
        if(!toEval) return;
        // sanitize: allow only digits, operators, dot
        if(!/^[\d+\-*/.() ]+$/.test(toEval)) {
          displayInput.value = 'Error';
          expr = '';
          current = '';
          return;
        }
        try {
          // Use Function instead of eval for slight safety
          // NOTE: this still evaluates JS math expressions only.
          let result = Function('"use strict"; return ('+toEval+')')();
          // format result (remove trailing .0)
          if (typeof result === 'number' && !Number.isInteger(result)) {
            result = parseFloat(result.toFixed(10)); // trim floating noise
          }
          expr = '';
          current = String(result);
          updateView();
        } catch(e){
          displayInput.value = 'Error';
          expr = '';
          current = '';
        }
      }

      // attach click handlers
      keys.forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const action = btn.dataset.action;
          const text = btn.textContent.trim();
          if(action === 'digit') appendDigit(text);
          else if(action === 'dot') appendDot();
          else if(action === 'op') pushOperator(text);
          else if(action === 'clear') clearAll();
          else if(action === 'back') backspace();
          else if(action === 'equal') evaluateExpr();
        });
      });

      // keyboard support
      window.addEventListener('keydown', (e)=>{
        if(e.key >= '0' && e.key <= '9'){ appendDigit(e.key); e.preventDefault(); }
        else if(e.key === '.') { appendDot(); e.preventDefault(); }
        else if(['+','-','*','/'].includes(e.key)){ pushOperator(e.key); e.preventDefault(); }
        else if(e.key === 'Enter' || e.key === '='){ evaluateExpr(); e.preventDefault(); }
        else if(e.key === 'Backspace'){ backspace(); e.preventDefault(); }
        else if(e.key === 'Escape'){ clearAll(); e.preventDefault(); }
      });

      // initial
      updateView();
    })();
  </script>
</body>
</html>
